from nopt import OptControlProblem


class InvertedPendulum(OptControlProblem):
    """
    Inverted pendulum problem

    Dynamics taken from:
      Li, Weiwei, and Emanuel Todorov. "Iterative linear quadratic 
      regulator design for nonlinear biological movement systems." 
      ICINCO (1). 2004.
    """
    
    def __init__(self, N: int=10, h: float=1e-5):
        """
        Args
        -----
        N (int): Grid size, aka number of steps
        """

        self.N = N
        self.dt = 1./N  # assuming t in [0, 1]

        self.h = h  # finite difference step size (when applicable)

        self.grav = 9.8
        self.m = self.l = 1
        self.mu = 0.01

        self.state_dim = 2
        self.input_dim = 1

        self.n = (self.N + 1) * self.state_dim + self.N * self.input_dim


        
